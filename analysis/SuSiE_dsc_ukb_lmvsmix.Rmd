---
title: "SuSiE-RSS lm vs mix"
author: "Yuxin Zou"
date: "01/01/2021"
output:
  workflowr::wflow_html:
    code_folding: hide
---

```{r warning=FALSE, message=FALSE}
library(dplyr)
library(kableExtra)
```

Mixed effects summary statistics are computed using GCTA. There are 100 data sets, each one has 2 simulated signals with total pve 0.01.
The phenotypes are generated from 
$$
y = X\beta + \epsilon.
$$
The summary statistics are from simple linear model, or linear mixed model. 

## NOT Estimate residual variance

### PIP calibration

![](assets/dsc.finemap.rss.ukb.mix/susie_rss_ukb_mix_pip_calibration/susie_rss_ukb_mix_pip_ERFALSE_pipcali.png)

### Power

![](assets/dsc.finemap.rss.ukb.mix/susie_rss_ukb_mix_roc/susie_rss_ukb_mix_pip_ERFALSE_roc_2_power.png)

### CS

![](assets/dsc.finemap.rss.ukb.mix/susie_rss_ukb_mix_cs_compare/susie_rss_ukb_mix_pip_ERFALSE_cs_plots.png)

```{r fig.align='center', fig.width=20, results='asis'}
output = 'results/dsc.finemap.rss.ukb.mix/susie_rss_ukb_mix_cs_compare/susie_rss_ukb_mix_pip_ERFALSE_cs.rds'
result = readRDS(output)
print(kableExtra::kable_styling(knitr::kable(round(result[,c(1,23:30)],4))))
```

## Estimate residual variance

### PIP calibration

![](assets/dsc.finemap.rss.ukb.mix/susie_rss_ukb_mix_pip_calibration/susie_rss_ukb_mix_pip_ERTRUE_pipcali.png)

### Power

![](assets/dsc.finemap.rss.ukb.mix/susie_rss_ukb_mix_roc/susie_rss_ukb_mix_pip_ERTRUE_roc_2_power.png)

### CS

![](assets/dsc.finemap.rss.ukb.mix/susie_rss_ukb_mix_cs_compare/susie_rss_ukb_mix_pip_ERTRUE_cs_plots.png)

```{r fig.align='center', fig.width=20, results='asis'}
output = 'results/dsc.finemap.rss.ukb.mix/susie_rss_ukb_mix_cs_compare/susie_rss_ukb_mix_pip_ERTRUE_cs.rds'
result = readRDS(output)
print(kableExtra::kable_styling(knitr::kable(round(result[,c(1,23:30)],4))))
```

